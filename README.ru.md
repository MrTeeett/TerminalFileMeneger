# TFM — Terminal File Manager (Go)

**TFM** — это быстрый, настраиваемый файловый менеджер для терминала, построенный на **Bubble Tea**.  
Он фокусируется на удобной навигации, предпросмотре, гибкой настройке клавиш/тем и лёгком расширении через команды.  

- **Стек:** Bubble Tea, Bubbles, Lip Gloss  
- **Платформы:** Linux (x86_64/arm64)  
- **Терминалы:** kitty, wezterm, iTerm2, alacritty, konsole, tmux (см. примечания)  

См. также:  
- `docs/SPEC.en.md` — спецификация и видение проекта  
- `docs/ARCHITECTURE.en.md` — архитектура и структура модулей  

Русская версия: `README.md`

---

## Возможности
- **Панели/Вкладки:** левая панель, правая панель, предпросмотр, вкладки  
- **Навигация:** клавиши Vim (h/j/k/l, gg/G), стрелки, PgUp/PgDn, Ctrl+U/D  
- **Предпросмотр:** текст/метаданные, встроенные изображения (iTerm2/WezTerm), ASCII-фолбэк  
- **Командный режим (:)**: `:help`, `:cd`, `:preview on|off|toggle`, `:theme`  
- **Копирование/Вставка:** файлов/каталогов и путей (yy/pp, Y/P и соответствующие `:copy…`)  
- **Темы и цвета:** настраиваемые стили, цветовые профили, прозрачность  

---

## Сборка и запуск
Требуется Go **1.21+**.

```bash
# Сборка
make build
# или
go build -o bin/tfm ./cmd/tfm

# Запуск
./bin/tfm
```

---

## Конфигурация
Файл конфигурации (TOML): `~/.config/tfm/config.toml`.  
Пример: `configs/config.example.toml`.

### Основные параметры (root):
- `show_hidden` — показывать скрытые файлы (dotfiles)  
- `open_dirs_right` — открывать каталоги справа  
- `right_pane_width` — ширина правой панели/предпросмотра (в процентах)  
- `color_profile` — `auto|none|ansi|256|truecolor` (рекомендуется `truecolor`)  
- `inline_images` — включить предпросмотр изображений (iTerm2/WezTerm)  
- `background_opacity` — прозрачность фона (`0..1` или `0..100%`)  
  - при значении `< 1` TFM избегает заливки фона, чтобы работала прозрачность терминала  
- `blur` — только флаг-подсказка; само размытие зависит от терминала/композитора  

### Привязка клавиш ([keys])
Любое действие можно переназначить:  

```toml
[keys]
"j" = "down"
"k" = "up"
"yy" = "copy"      # копировать файл/директорию
"pp" = "paste"     # вставить в текущую директорию
"Y"  = "copy-path" # скопировать абсолютный путь
"P"  = "paste-path"# перейти к скопированному пути (cd/select)
```

Полный список действий — в `configs/config.example.toml`.

---

## Командный режим (:)
- `:help` — помощь  
- `:cd <path>` — смена каталога (`~` и относительные пути поддерживаются)  
- `:preview on|off|toggle` — управление предпросмотром  
- `:copy`, `:paste`, `:copy-path`, `:paste-path`  
- `:theme` — диагностика тем/цветов (профиль, TERM/COLORTERM, примеры)  
- `:opacity <0..1|0..100>` — динамическая настройка прозрачности  
- `:blur on|off` — переключатель подсказки для размытия  

---

## Предпросмотр изображений
- Встроенные изображения для iTerm2/WezTerm (OSC 1337)  
- Kitty/ASCII — автоматический фолбэк (текст/ASCII)  
- Отключение: `inline_images = false` или `TFM_NO_INLINE_IMAGES=1`  

---

## Цвета и прозрачность
- Цветовой профиль определяется автоматически или задаётся через `color_profile`  
- Для kitty/wezterm рекомендуется **TrueColor**  
- Для прозрачности установите `background_opacity < 1.0` и включите прозрачность в терминале;  
  размытие требует поддержки терминала/композитора  

---

## Отладка (VS Code)
- Используйте внешний терминал и **legacy adapter** для стабильности:  
  - `console: externalTerminal`  
  - `debugAdapter: legacy`  
- Внешний терминал настраивается через `terminal.external.*` в VS Code  

---

## Архитектура
- **Приложение:** `internal/app`  
- **Конфигурация/Тема/Клавиши:** `internal/config`, `internal/theme`, `internal/keymap`  
- **Файловые операции:** `internal/fs/ops` (копирование/перемещение/удаление, рекурсивное копирование)  
- **UI (TUI):** `internal/ui/tui` (модель, рендеринг макета, командный режим)  
- **Предпросмотр:** `internal/ui/preview` (провайдеры)  

Подробнее см. в `docs/ARCHITECTURE.en.md`.

---

## Лицензия
См. LICENSE (MIT).

---

## Благодарности
- Charmbracelet: Bubble Tea / Bubbles / Lip Gloss  
- Сообщество терминальных приложений за идеи и вдохновение  
